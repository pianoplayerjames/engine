const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/thinEngine-CR4gHlLq.js","assets/dataBuffer-BEUz_e_e.js","assets/tools.functions-Cy84Um-0.js","assets/index-BSOJ-fS9.js","assets/vendor-BdWBIe4_.js","assets/rolldown-runtime-9SXAGcFL.js","assets/index-27V22rMo.css","assets/engineStore-ChlzyWX_.js","assets/observable-8SYwW91n.js","assets/shaderStore-e8RCqiF-.js","assets/precisionDate-CPBgBNTn.js","assets/logger-D2dXBhXY.js","assets/thinEngine-BctTIz6g.js","assets/pass.fragment-BK9seQoW.js","assets/pass.fragment-CNAbPlFy.js"])))=>i.map(i=>d[i]);
import{b as e}from"./index-BSOJ-fS9.js";import{b as t}from"./engineStore-ChlzyWX_.js";import{b as n}from"./math.scalar.functions-DzEGaKm0.js";import{c as r}from"./tools-BmEJizBm.js";import{b as i,c as a}from"./effectRenderer-Byjm_Yfr.js";let o,s=null;async function c(){return s||=new Promise((n,r)=>{let s,c=null,l={preserveDrawingBuffer:!0,depth:!1,stencil:!1,alpha:!0,premultipliedAlpha:!1,antialias:!1,failIfMajorPerformanceCaveat:!1};e(async()=>{let{ThinEngine:e}=await import(`./thinEngine-CR4gHlLq.js`);return{ThinEngine:e}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12])).then(({ThinEngine:u})=>{let d=t.Instances.length;try{s=new OffscreenCanvas(100,100),c=new u(s,!1,l)}catch{d<t.Instances.length&&t.Instances.pop()?.dispose(),s=document.createElement(`canvas`),c=new u(s,!1,l)}t.Instances.pop(),t.OnEnginesDisposedObservable.add(e=>{c&&e!==c&&!c.isDisposed&&t.Instances.length===0&&f()}),c.getCaps().parallelShaderCompile=void 0;let p=new i(c);e(async()=>{let{passPixelShader:e}=await import(`./pass.fragment-BK9seQoW.js`);return{passPixelShader:e}},__vite__mapDeps([13,9,14])).then(({passPixelShader:e})=>{if(!c){r(`Engine is not defined`);return}let t=new a({engine:c,name:e.name,fragmentShader:e.shader,samplerNames:[`textureSampler`]});o={canvas:s,engine:c,renderer:p,wrapper:t},n(o)})}).catch(r)}),await s}async function l(e,t,n,r,i=`image/png`,a,o){let s=await n.readPixels(0,0,e,t),c=new Uint8Array(s.buffer);d(e,t,c,r,i,a,!0,void 0,o)}async function u(e,t,n,r=`image/png`,i,a=!1,o=!1,s){return await new Promise(c=>{d(e,t,n,e=>c(e),r,i,a,o,s)})}function d(e,t,i,a,o=`image/png`,s,l=!1,u=!1,d){c().then(c=>{if(c.engine.setSize(e,t,!0),i instanceof Float32Array){let e=new Uint8Array(i.length),t=i.length;for(;t--;){let r=i[t];e[t]=Math.round(n(r)*255)}i=e}let f=c.engine.createRawTexture(i,e,t,5,!1,!l,1);c.renderer.setViewport(),c.renderer.applyEffectWrapper(c.wrapper),c.wrapper.effect._bindTexture(`textureSampler`,f),c.renderer.draw(),u?r.ToBlob(c.canvas,e=>{let t=new FileReader;t.onload=e=>{let t=e.target.result;a&&a(t)},t.readAsArrayBuffer(e)},o,d):r.EncodeScreenshotCanvasData(c.canvas,a,o,s,d),f.dispose()})}function f(){o?(o.wrapper.dispose(),o.renderer.dispose(),o.engine.dispose()):s?.then(e=>{e.wrapper.dispose(),e.renderer.dispose(),e.engine.dispose()}),s=null,o=null}const p={DumpData:d,DumpDataAsync:u,DumpFramebuffer:l,Dispose:f},m=()=>{r.DumpData=d,r.DumpDataAsync=u,r.DumpFramebuffer=l};m();export{f as b,d as c,u as d,l as e,p as f};