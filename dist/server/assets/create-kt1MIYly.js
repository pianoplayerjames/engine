import{b as e}from"./vendor-B3dnqQpG.js";import{Suspense as t,lazy as n,useEffect as r}from"react";import{Route as i,Routes as a,StaticRouter as o,useLocation as s}from"react-router";import{createPath as c}from"history";import{proxy as l}from"valtio";import{RouteContext as u}from"@fastify/react/client";import{jsx as d}from"react/jsx-runtime";const f=()=>import(`./default-BQZOOUrm.js`),p={};Object.keys(p).some(e=>e.match(/\/layouts\/default\.(j|t)sx/))||(p[`/layouts/default.jsx`]=f);var m=Object.fromEntries(Object.keys(p).map(e=>{let t=e.slice(9,-4);return[t,n(p[e])]}));const h=new Map,g=new Map;function _(e,t,n,r=g){let i=`${e}:${t}`,a=r.get(i);if(a){if(a.error)throw a.error;if(a.suspended)throw a.promise;return r.delete(i),a.result}let o={suspended:!0,error:null,result:null,promise:null};return o.promise=n().then(e=>{o.result=e}).catch(e=>{o.error=e}).finally(()=>{o.suspended=!1}),r.set(i,o),_(e,t)}function v(e,t={},n=h){let r=n.get(e);if(r){if(r.error||r.data?.statusCode===500)throw r.data?.statusCode===500?Error(r.data.message):r.error;if(r.suspended)throw r.promise;return n.delete(e),r.data}let i={suspended:!0,error:null,data:null,promise:null};return i.promise=fetch(e,t).then(e=>e.json()).then(e=>{i.data=e}).catch(e=>{i.error=e}).finally(()=>{i.suspended=!1}),n.set(e,i),v(e,t,n)}const y=o;function b({ctxHydration:e,ctx:t,children:n}){{let r=m[e.layout??`default`];return d(u.Provider,{value:{...t,...e,state:e.state??{}},children:d(r,{children:n})})}t.firstRender=window.route.firstRender,t.firstRender?(t.data=window.route.data,t.head=window.route.head):(t.data=void 0,t.head=void 0);let i=s(),a=c(i);if(r(()=>{window.route.firstRender=!1,window.route.actionData={}},[i]),!t.data&&t.getData)try{let{pathname:e,search:n}=i;t.data=v(`/-/data${e}${n}`)}catch(e){throw e instanceof Error&&(t.error=e),e}if(!t.firstRender&&t.getMeta){let n=async()=>{let{getMeta:n}=await t.loader();t.head=await n(t),e.useHead.push(t.head)};_(a,`updateMeta`,n)}if(!t.firstRender&&t.onEnter){let e=async()=>{let{onEnter:e}=await t.loader(),n=await e(t);t.data||={},Object.assign(t.data,n)};_(a,`onEnter`,e)}let o=m[t.layout??`default`];return d(u.Provider,{value:{...e,...t,state:e.state??{}},children:d(o,{children:n})})}function x({url:e,routes:n,head:r,ctxHydration:o,routeMap:s}){return d(t,{children:d(y,{location:e,children:d(a,{children:n.map(({path:e,component:t})=>d(i,{path:e,element:d(b,{head:r,ctxHydration:o,ctx:s[e],children:d(t,{})})},e))})})})}function S({url:t,...n}){let r=e;return d(r,{value:n.ctxHydration.useHead,children:d(x,{url:t,...n})})}export{S as default};